---
import { Button } from "@/shared/ui/button";
import { Input } from "@/shared/ui/input";
import { Textarea } from "@shared/ui/textarea";
---

<div class="max-w-2xl w-full mx-auto border rounded-lg shadow-lg p-6">
  <h1 class="text-2xl font-bold mb-6">WebRTC Chat</h1>

  <div class="space-y-6">
    <div class="rounded-md">
      <p id="stat" class="text-sm text-gray-600"></p>
    </div>

    <!-- Role Selection -->
    <div class="grid grid-cols-2 gap-4 mb-6">
      <Button id="createBtn" class="w-full">Create Chat</Button>
      <Button id="joinBtn" class="w-full">Join Chat</Button>
    </div>

    <!-- Creator Section -->
    <div id="creatorSection" class="space-y-4 hidden">
      <Button id="createOfferBtn" class="w-full">Create Offer</Button>
      <div class="space-y-2">
        <label class="text-sm text-gray-600">Your Offer (Share this):</label>
        <Textarea id="offerOutput" rows="4" readonly class="w-full" />
      </div>
      <div class="space-y-2">
        <label class="text-sm text-gray-600">Paste Answer Here:</label>
        <Textarea
          id="answerInput"
          rows="4"
          placeholder="Paste the answer you received here"
          class="w-full"
        />
        <Button id="connectBtn" class="w-full">Connect</Button>
      </div>
    </div>

    <!-- Joiner Section -->
    <div id="joinerSection" class="space-y-4 hidden">
      <div class="space-y-2">
        <label class="text-sm text-gray-600">Paste Offer Here:</label>
        <Textarea
          id="offerInput"
          rows="4"
          placeholder="Paste the offer you received here"
          class="w-full"
        />
      </div>
      <Button id="joinChatBtn" class="w-full">Join Chat</Button>
      <div class="space-y-2">
        <label class="text-sm text-gray-600">Your Answer (Share this):</label>
        <Textarea id="answerOutput" rows="4" readonly class="w-full" />
      </div>
    </div>

    <div class="space-y-3">
      <div class="flex items-center gap-3">
        <Button id="button"> Create Offer </Button>
      </div>
      <Textarea
        id="offer"
        placeholder="Paste offer here. Press Enter to proceed."
      />
    </div>

    <div class="space-y-2">
      <Textarea id="answer" placeholder="Answer" />
    </div>

    <div class="space-y-4">
      <div>
        <Input id="chat" type="text" placeholder="Type your message..." />
      </div>

      <!-- <video id="remoteVideo" autoplay muted></video> -->
      <div class="rounded-md p-4 h-64 overflow-y-auto">
        <video id="sharedVideo" class="w-full rounded-lg" controls></video>
        <pre
          id="output"
          class="text-sm text-gray-600 whitespace-pre-wrap">
Chat: </pre>
      </div>
    </div>
  </div>
</div>

<script src="../../webrtc/connection/lib/initialize.ts"></script>
<script>
  // Role buttons
  const createBtn = document.getElementById("createBtn");
  const joinBtn = document.getElementById("joinBtn");

  // Role sections
  const creatorSection = document.getElementById("creatorSection");
  const joinerSection = document.getElementById("joinerSection");

  // Role selection
  createBtn.addEventListener("click", () => {
    creatorSection.classList.remove("hidden");
    joinerSection.classList.add("hidden");
    // initializePeerConnection();
  });

  joinBtn.addEventListener("click", () => {
    joinerSection.classList.remove("hidden");
    creatorSection.classList.add("hidden");
    // initializePeerConnection();
  });
</script>
